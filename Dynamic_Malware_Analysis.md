## Analysis of a RedLine Stealer sample. The malware uses PowerShell for data harvesting and establishes persistence via Scheduled Tasks and hidden directory creation in AppData. <br>
## 1. Indicators of Compromise (IOCs)
* **File Hash (SHA-256):** ab82c433b4a5e763de3427295657629780fa2157f0db9975c643ba4610b5d885
* **Malicious Process:** powershell.exe (High CPU usage, DLL access)
* **Dropped Executable:** %AppData%\Roaming\mviXtlzGrZrBSb.exe
* **Persistence Task:** Scheduled Task named "Updates"



## 2. Analysis Setup & Identification
I started by checking the file's reputation. **HashMyFiles** gave me the fingerprint, and **VirusTotal** confirmed it's a "RedLine Stealer".<br>
SHA-256 hash for this sample is ab82c433b4a5e763de3427295657629780fa2157f0db9975c643ba4610b5d885<br>

<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/HashmyFiles%20pierwszy%20scan%20ca%C5%82o%C5%9Bci.png?raw=true" width="900" /> <br>
<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/zdjecie%20malware%20z%20virustotal.png?raw=true" width="900" /> <br>

## 3. Malware Execution & System Impact <br>
When I ran the malware, **Process Hacker** showed it using **PowerShell** to scan my system. <br>


This screenshot from Process Hacker capture the exact moment of infection. The malware spawned multiple PowerShell instances, with one consuming over 31% of the CPU to harvest data. Simultaneously, the process schtasks.exe was observed, confirming the malware's attempt to establish persistence via the Task Scheduler. <br>
<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/egzekucja%20malware1123.png" width="900" /> <br>
Process Monitor confirmed that powershell.exe (PID 8988) accessed critical system DLLs (ntdll.dll, kernel32.dll) to interact with the OS at a low level <br>
<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/process%20monitor.png" width="900" /> <br>

## 4. Registry & Filesystem Changes
I used **Regshot** to see what changed. The malware made 582 changes to the system.

* **Persistence:** It created a hidden folder called "Updates" in the registry.

<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/compare1.png" width="900" />
<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/compare2.png" width="900" />

## 5. Network Isolation
I used **Wireshark** to monitor traffic. Since I used a **LAN Segment**, the malware couldn't talk to its Command & Control server.

<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/wireshark%20proba%20nawiazania%20polaczenia.png" width="900" />

## 6. Persistence & Stealth
The malware created a **Scheduled Task** to run every time Windows starts.

* **Hidden File:** The malicious task was configured to execute %AppData%\Roaming\mviXtlzGrZrBSb.exe
* **Evasion:** Even with "Hidden Items" on, the file was invisible in the folder.

<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/Scheduled%20task.png" width="900" />
<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/ukrycie%20sie%20malware.png" width="900" />

