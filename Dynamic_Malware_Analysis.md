## Table of Contents
1. [Lab Environment & Tools](#sekcja-1)
2. [Indicators of Compromise](#sekcja-2)
3. [Analysis Setup & Identification](#sekcja-3)
4. [Malware Execution & System Impact](#sekcja-4)
5. [Registry & Filesystem Changes](#sekcja-5)
6. [Network Isolation](#sekcja-6)
7. [Persistence & Stealth](#sekcja-7)
<a name="sekcja-1"></a>
# 1. Lab Environment & Tools <br>
Analysis of a RedLine Stealer sample. The malware uses PowerShell for data harvesting and establishes persistence via Scheduled Tasks and hidden directory creation in AppData.
To ensure safety, the analysis was performed in a fully isolated virtual environment. <br>

OS: Windows 10 Pro (Isolated VM) <br>
Network: LAN Segment (No Internet access to prevent C2 communication) <br>
Analysis Type: Dynamic Malware Analysis <br> 

## Software used: <br>
Process Hacker Real-time process monitoring and tree inspection <br>
Wireshark Network - traffic sniffing and protocol analysis <br>
RegshotRegistry and filesystem snapshot comparison <br>
Process Monitor(ProcMon) - Detailed system event logging (file/registry/thread) <br>
HashMyFiles - file identification and hashing <br>
VirusTotal - Reputation check <br>

<a name="sekcja-2"></a>
## 2. Indicators of Compromise
* **File Hash (SHA-256):** ab82c433b4a5e763de3427295657629780fa2157f0db9975c643ba4610b5d885
* **Malicious Process:** powershell.exe (High CPU usage, DLL access)
* **Dropped Executable:** %AppData%\Roaming\mviXtlzGrZrBSb.exe
* **Persistence Task:** Scheduled Task named "Updates"


<a name="sekcja-3"></a>
## 3. Analysis Setup & Identification
I started by checking the file's reputation. **HashMyFiles** gave me the fingerprint, and **VirusTotal** confirmed it's a "RedLine Stealer".<br>
SHA-256 hash for this sample is ab82c433b4a5e763de3427295657629780fa2157f0db9975c643ba4610b5d885<br>

<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/HashmyFiles%20pierwszy%20scan%20ca%C5%82o%C5%9Bci.png?raw=true" width="900" /> <br>
<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/zdjecie%20malware%20z%20virustotal.png?raw=true" width="900" /> <br>
<a name="sekcja-4"></a>
## 4. Malware Execution & System Impact <br>
When I ran the malware, **Process Hacker** showed it using **PowerShell** to scan my system. <br>


This screenshot from Process Hacker capture the exact moment of infection. The malware spawned multiple PowerShell instances, with one consuming over 31% of the CPU to harvest data. Simultaneously, the process schtasks.exe was observed, confirming the malware's attempt to establish persistence via the Task Scheduler. <br>
<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/egzekucja%20malware1123.png" width="900" /> <br>
Process Monitor confirmed that powershell.exe (PID 8988) accessed critical system DLLs (ntdll.dll, kernel32.dll) to interact with the OS at a low level <br>
<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/process%20monitor.png" width="900" /> <br>
<a name="sekcja-5"></a>
## 5. Registry & Filesystem Changes
I used **Regshot** to see what changed. The malware made 582 changes to the system.

* **Persistence:** It created a hidden folder called "Updates" in the registry.

<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/compare1.png" width="900" /> <br>
<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/compare2.png" width="900" /> <br>
<a name="sekcja-6"></a> <br>
## 6. Network Isolation <br>
I used **Wireshark** to monitor traffic. Since I used a **LAN Segment**, the malware couldn't talk to its Command & Control server.

<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/wireshark%20proba%20nawiazania%20polaczenia.png" width="900" />
<a name="sekcja-7"></a> <br>

## 7. Persistence & Stealth <br>

The malware created a **Scheduled Task** to run every time Windows starts. <br>

* **Hidden File:** The malicious task was configured to execute %AppData%\Roaming\mviXtlzGrZrBSb.exe <br>
* **Evasion:** Even with "Hidden Items" on, the file was invisible in the folder. <br>

<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/Scheduled%20task.png" width="900" />
<img src="https://github.com/Patrykziok/SOC-homelab-portfolio/blob/main/images/ukrycie%20sie%20malware.png" width="900" />

